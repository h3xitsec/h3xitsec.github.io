<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="PicoCTF 2022 - Crypto Challenges" /><meta name="author" content="h3xit" /><meta property="og:locale" content="en" /><meta name="description" content="Basic Mod 1 Challenge 1 2 3 4 We found this weird message being passed around on the servers, we think we have a working decrpytion scheme. Download the message here. Take each number mod 37 and map it to the following character set: 0-25 is the alphabet (uppercase), 26-35 are the decimal digits, and 36 is an underscore. Wrap your decrypted message in the picoCTF flag format (i.e. picoCTF{decrypted_message})" /><meta property="og:description" content="Basic Mod 1 Challenge 1 2 3 4 We found this weird message being passed around on the servers, we think we have a working decrpytion scheme. Download the message here. Take each number mod 37 and map it to the following character set: 0-25 is the alphabet (uppercase), 26-35 are the decimal digits, and 36 is an underscore. Wrap your decrypted message in the picoCTF flag format (i.e. picoCTF{decrypted_message})" /><link rel="canonical" href="https://h3xitsec.github.io/posts/picoctf-crypto/" /><meta property="og:url" content="https://h3xitsec.github.io/posts/picoctf-crypto/" /><meta property="og:site_name" content="h3xit’s ~" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-29T00:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PicoCTF 2022 - Crypto Challenges" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@h3xit" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"h3xit"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://h3xitsec.github.io/posts/picoctf-crypto/"},"description":"Basic Mod 1 Challenge 1 2 3 4 We found this weird message being passed around on the servers, we think we have a working decrpytion scheme. Download the message here. Take each number mod 37 and map it to the following character set: 0-25 is the alphabet (uppercase), 26-35 are the decimal digits, and 36 is an underscore. Wrap your decrypted message in the picoCTF flag format (i.e. picoCTF{decrypted_message})","url":"https://h3xitsec.github.io/posts/picoctf-crypto/","@type":"BlogPosting","headline":"PicoCTF 2022 - Crypto Challenges","dateModified":"2022-03-29T23:58:53-04:00","datePublished":"2022-03-29T00:00:00-04:00","@context":"https://schema.org"}</script><title>PicoCTF 2022 - Crypto Challenges | h3xit's ~</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="h3xit's ~"><meta name="application-name" content="h3xit's ~"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">h3xit's ~</a></div><div class="site-subtitle font-italic">CTF Writeups and other stuff about my journey into cybersecurity</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/h3xitsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['h3xit','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>PicoCTF 2022 - Crypto Challenges</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>PicoCTF 2022 - Crypto Challenges</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/h3xitsec">h3xit</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-03-29 00:00:00 -0400" data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 29, 2022, 12:00 AM -0400" >Mar 29</em> </span> <span> Updated <em class="timeago" date="2022-03-29 23:58:53 -0400 " data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 29, 2022, 11:58 PM -0400" >Mar 29</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1015 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h1 id="basic-mod-1">Basic Mod 1</h1><h2 id="challenge">Challenge<a href="#challenge" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>We found this weird message being passed around on the servers, we think we have a working decrpytion scheme.
Download the message here.
Take each number mod 37 and map it to the following character set: 0-25 is the alphabet (uppercase), 26-35 are the decimal digits, and 36 is an underscore.
Wrap your decrypted message in the picoCTF flag format (i.e. picoCTF{decrypted_message})
</pre></table></code></div></div><h3 id="messagetxt">message.txt<a href="#messagetxt" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>91
322
57
124
40
406
272
147 
239
285
353
272
77
110
296
262
299
323
255
337
150
102
</pre></table></code></div></div><h2 id="solution">Solution<a href="#solution" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span><span class="n">flag</span> <span class="o">=</span> <span class="s">''</span>
<span class="nb">map</span> <span class="o">=</span> <span class="p">[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">,</span><span class="s">'C'</span><span class="p">,</span><span class="s">'D'</span><span class="p">,</span><span class="s">'E'</span><span class="p">,</span><span class="s">'F'</span><span class="p">,</span><span class="s">'G'</span><span class="p">,</span><span class="s">'H'</span><span class="p">,</span><span class="s">'I'</span><span class="p">,</span><span class="s">'J'</span><span class="p">,</span><span class="s">'K'</span><span class="p">,</span><span class="s">'L'</span><span class="p">,</span><span class="s">'M'</span><span class="p">,</span><span class="s">'N'</span><span class="p">,</span><span class="s">'O'</span><span class="p">,</span><span class="s">'P'</span><span class="p">,</span><span class="s">'Q'</span><span class="p">,</span><span class="s">'R'</span><span class="p">,</span><span class="s">'S'</span><span class="p">,</span><span class="s">'T'</span><span class="p">,</span><span class="s">'U'</span><span class="p">,</span><span class="s">'V'</span><span class="p">,</span><span class="s">'W'</span><span class="p">,</span><span class="s">'X'</span><span class="p">,</span><span class="s">'Y'</span><span class="p">,</span><span class="s">'Z'</span><span class="p">,</span><span class="s">'0'</span><span class="p">,</span><span class="s">'1'</span><span class="p">,</span><span class="s">'2'</span><span class="p">,</span><span class="s">'3'</span><span class="p">,</span><span class="s">'4'</span><span class="p">,</span><span class="s">'5'</span><span class="p">,</span><span class="s">'6'</span><span class="p">,</span><span class="s">'7'</span><span class="p">,</span><span class="s">'8'</span><span class="p">,</span><span class="s">'9'</span><span class="p">,</span><span class="s">'_'</span><span class="p">]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'message.txt'</span><span class="p">,</span><span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">file</span><span class="p">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">%</span> <span class="mi">37</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span> <span class="o">+</span> <span class="nb">map</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>R0UND_N_R0UND_ADD17EC2
</pre></table></code></div></div><h1 id="basic-mod-2">Basic Mod 2</h1><h2 id="challenge-1">Challenge<a href="#challenge-1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>A new modular challenge!
Download the message here.
Take each number mod 41 and find the modular inverse for the result. Then map to the following character set: 1-26 are the alphabet, 27-36 are the decimal digits, and 37 is an underscore.
Wrap your decrypted message in the picoCTF flag format (i.e. picoCTF{decrypted_message})
</pre></table></code></div></div><h3 id="messagetxt-1">message.txt<a href="#messagetxt-1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>104
290
356
313
262
337
354
229
146
297
118
373
221
359
338
321
288
79
214
277
131
190
377
</pre></table></code></div></div><h2 id="solution-1">Solution<a href="#solution-1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span><span class="k">def</span> <span class="nf">modinv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s">''</span>
<span class="nb">map</span> <span class="o">=</span> <span class="p">[</span><span class="s">''</span><span class="p">,</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">,</span><span class="s">'C'</span><span class="p">,</span><span class="s">'D'</span><span class="p">,</span><span class="s">'E'</span><span class="p">,</span><span class="s">'F'</span><span class="p">,</span><span class="s">'G'</span><span class="p">,</span><span class="s">'H'</span><span class="p">,</span><span class="s">'I'</span><span class="p">,</span><span class="s">'J'</span><span class="p">,</span><span class="s">'K'</span><span class="p">,</span><span class="s">'L'</span><span class="p">,</span><span class="s">'M'</span><span class="p">,</span><span class="s">'N'</span><span class="p">,</span><span class="s">'O'</span><span class="p">,</span><span class="s">'P'</span><span class="p">,</span><span class="s">'Q'</span><span class="p">,</span><span class="s">'R'</span><span class="p">,</span><span class="s">'S'</span><span class="p">,</span><span class="s">'T'</span><span class="p">,</span><span class="s">'U'</span><span class="p">,</span><span class="s">'V'</span><span class="p">,</span><span class="s">'W'</span><span class="p">,</span><span class="s">'X'</span><span class="p">,</span><span class="s">'Y'</span><span class="p">,</span><span class="s">'Z'</span><span class="p">,</span><span class="s">'0'</span><span class="p">,</span><span class="s">'1'</span><span class="p">,</span><span class="s">'2'</span><span class="p">,</span><span class="s">'3'</span><span class="p">,</span><span class="s">'4'</span><span class="p">,</span><span class="s">'5'</span><span class="p">,</span><span class="s">'6'</span><span class="p">,</span><span class="s">'7'</span><span class="p">,</span><span class="s">'8'</span><span class="p">,</span><span class="s">'9'</span><span class="p">,</span><span class="s">'_'</span><span class="p">]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'message.txt'</span><span class="p">,</span><span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">file</span><span class="p">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
        <span class="n">char</span> <span class="o">=</span> <span class="n">char</span> <span class="o">%</span> <span class="mi">41</span>
        <span class="n">char</span> <span class="o">=</span> <span class="n">modinv</span><span class="p">(</span><span class="n">char</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span> <span class="o">+</span> <span class="nb">map</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>1NV3R53LY_H4RD_8A05D939
</pre></table></code></div></div><h1 id="cred-stuff">Cred Stuff</h1><h2 id="challenge-2">Challenge<a href="#challenge-2" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>We found a leak of a blackmarket website's login credentials. Can you find the password of the user cultiris and successfully decrypt it?
Download the leak here.
The first user in usernames.txt corresponds to the first password in passwords.txt. The second user corresponds to the second password, and so on.
</pre></table></code></div></div><p>The files provided are a list of username and a list of password</p><h2 id="solution-2">Solution<a href="#solution-2" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-n</span> cultiris usernames.txt
378:cultiris
<span class="nv">$ </span><span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'378p'</span> passwords.txt
cvpbPGS<span class="o">{</span>P7e1S_54I35_71Z3<span class="o">}</span>
</pre></table></code></div></div><p>Use Cyberchef to decode ROT13 encoded flag: cvpbPGS{P7e1S_54I35_71Z3} = picoCTF{C7r1F_54V35_71M3}</p><h1 id="very-smooth">Very Smooth</h1><h2 id="challenge-3">Challenge<a href="#challenge-3" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We are given 2 files:</p><ul><li>gen.py<li>output.txt</ul><h3 id="genpy">gen.py<a href="#genpy" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python
</span>
<span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">hexlify</span>
<span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="n">sys</span><span class="p">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
    <span class="n">math</span><span class="p">.</span><span class="n">gcd</span> <span class="o">=</span> <span class="n">gcd</span>
    <span class="n">math</span><span class="p">.</span><span class="n">lcm</span> <span class="o">=</span> <span class="n">lcm</span>

<span class="n">_DEBUG</span> <span class="o">=</span> <span class="bp">True</span>

<span class="n">FLAG</span>  <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt'</span><span class="p">).</span><span class="n">read</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
<span class="n">FLAG</span>  <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="n">hexlify</span><span class="p">(</span><span class="n">FLAG</span><span class="p">.</span><span class="n">encode</span><span class="p">()),</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">SEED</span>  <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="n">hexlify</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)).</span><span class="n">decode</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">STATE</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_prime</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">bits</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">next_prime</span><span class="p">(</span><span class="n">mpz_urandomb</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">bits</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">bits</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">get_smooth_prime</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">bits</span><span class="p">,</span> <span class="n">smoothness</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p_factors</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">p</span><span class="p">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">bits</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">smoothness</span><span class="p">:</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">get_prime</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">smoothness</span><span class="p">)</span>
        <span class="n">p_factors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">*=</span> <span class="n">factor</span>
    <span class="n">bitcnt</span> <span class="o">=</span> <span class="p">(</span><span class="n">bits</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">bit_length</span><span class="p">())</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">prime1</span> <span class="o">=</span> <span class="n">get_prime</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">bitcnt</span><span class="p">)</span>
        <span class="n">prime2</span> <span class="o">=</span> <span class="n">get_prime</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">bitcnt</span><span class="p">)</span>
        <span class="n">tmpp</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">prime1</span> <span class="o">*</span> <span class="n">prime2</span>
        <span class="k">if</span> <span class="n">tmpp</span><span class="p">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">bits</span><span class="p">:</span>
            <span class="n">bitcnt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">tmpp</span><span class="p">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">bits</span><span class="p">:</span>
            <span class="n">bitcnt</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">tmpp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">p_factors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime1</span><span class="p">)</span>
            <span class="n">p_factors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime2</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">tmpp</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">break</span>
    <span class="n">p_factors</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_factors</span><span class="p">)</span>

<span class="n">e</span> <span class="o">=</span> <span class="mh">0x10001</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">p_factors</span> <span class="o">=</span> <span class="n">get_smooth_prime</span><span class="p">(</span><span class="n">STATE</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_factors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p_factors</span><span class="p">)):</span>
        <span class="k">continue</span>
    <span class="c1"># Smoothness should be different or some might encounter issues.
</span>    <span class="n">q</span><span class="p">,</span> <span class="n">q_factors</span> <span class="o">=</span> <span class="n">get_smooth_prime</span><span class="p">(</span><span class="n">STATE</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_factors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">q_factors</span><span class="p">)):</span>
        <span class="k">continue</span>
    <span class="n">factors</span> <span class="o">=</span> <span class="n">p_factors</span> <span class="o">+</span> <span class="n">q_factors</span>
    <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">:</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">_DEBUG</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">'p = </span><span class="si">{</span><span class="n">p</span><span class="p">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">'p_factors = [</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">p_factors</span><span class="p">:</span>
        <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">'    </span><span class="si">{</span><span class="n">factor</span><span class="p">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="s">,</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">']</span><span class="se">\n\n</span><span class="s">'</span><span class="p">)</span>

    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">'q = </span><span class="si">{</span><span class="n">q</span><span class="p">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">'q_factors = [</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">q_factors</span><span class="p">:</span>
        <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">'    </span><span class="si">{</span><span class="n">factor</span><span class="p">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="s">,</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">']</span><span class="se">\n\n</span><span class="s">'</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'n = </span><span class="si">{</span><span class="n">n</span><span class="p">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'c = </span><span class="si">{</span><span class="n">c</span><span class="p">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="outputtxt">output.txt<a href="#outputtxt" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>n = 6c5f4a08d820579e606aeb3800d1602c53825167d01bd7c87f43041afdc82877c50bbcc7830a0bf8c718fc9016e4a9e73ff0dfe1edd38688acb6add89b2bd6264d61e2ce0c9b3b0813b46b0eb1fcfc56b9f7f072ba2e1e986e6420f8ad9063e10fa9bca464b23fcf0135f95dc11a89bfddf2e81572c196f4362ea551aee18b343638d9d703b234e788bff4ddc3e885da77c7940a0fa670ddc1604646871f0739199fa7fa01f9ed7d84fb9f0cc82965450e7c97153fec84ef8e10a7fceb37a90e847a012528c733070e9ab751215b13a7e2d485089c0c4d00b81dbab382ef7681c717c76c2b14ce6495ef121540653561c3dd519c5f6e2ead18e9d90f3769a029
c = 42cbc15285a307d86ac5184c89d6bea5ebdc0a7546debedfe40af69fa6813eaf11ef86543349062587621b845e82817cf7f154c067733ee8b23a75e45861ee0c45a07e702dcb199adffa4ca0892fcd85abfe9e9b59c2ac2df7811a656a3fda16f385972107481409e33e820a19864233b8a35bc49734dc337786dc06c0460a4ec9fc06d16fd66a43654390a526ab0a6239b14427a9868399f6e4863ac04539690357e9a4fa67450286febd9a97dd07864f516f6756c2ffad0b1ba5882980f0089605f0def91120a80a448f77ec272be41de0e11695ba7d0c8899b1d9e8905a1b5e95a755e584dead086f35844052f261e8dcd0d6cffdce38cd5181235dfa0745
</pre></table></code></div></div><h2 id="solution-3">Solution<a href="#solution-3" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>The solution for this challenge is some basic RSA maths. We have n,c (public modulus, ciphertext) from output.txt and e (public exponent) from gen.py. It’s pretty clear that we have to recover plaintext from ciphertext. Steps for solving:</p><ul><li>Generate public key with n,e<li>Factor n to get p,q<li>Decrypt ciphertext with pt = c ** d % e</ul><p>For sake of simplicity, I used goRsaTool for the first steps</p><h3 id="solvepy">solve.py<a href="#solvepy" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'output.txt'</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="s">'0x'</span><span class="o">+</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'n = ([0-9a-f]*)'</span><span class="p">).</span><span class="n">search</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="s">'0x'</span><span class="o">+</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'c = ([0-9a-f]*)'</span><span class="p">).</span><span class="n">search</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">e</span> <span class="o">=</span> <span class="mh">0x10001</span>
<span class="c1"># Generate public key from n,e
</span><span class="n">pubkey</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">'goRsaTool'</span><span class="p">,</span><span class="s">'-n'</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="s">'-e'</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="s">'-createkey'</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">pubkeyfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'pub.key'</span><span class="p">,</span><span class="s">'w'</span><span class="p">)</span>
<span class="n">pubkeyfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pubkey</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">()))</span>
<span class="n">pubkeyfile</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Generate private key using Pollard's p-1 attack
</span><span class="n">privkey</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">'goRsaTool'</span><span class="p">,</span><span class="s">'-key'</span><span class="p">,</span><span class="s">'./pub.key'</span><span class="p">,</span><span class="s">'-attack'</span><span class="p">,</span><span class="s">'pollardsp1'</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">privkeyfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'priv.key'</span><span class="p">,</span><span class="s">'w'</span><span class="p">)</span>
<span class="n">privkeyfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">privkey</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">()))</span>
<span class="n">privkeyfile</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Extract n,d,p,q,e from private key output
</span><span class="n">privparams</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">'goRsaTool'</span><span class="p">,</span><span class="s">'-key'</span><span class="p">,</span><span class="s">'./priv.key'</span><span class="p">,</span><span class="s">'-dumpkey'</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">priv_n</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'n = ([0-9]*)'</span><span class="p">).</span><span class="n">search</span><span class="p">(</span><span class="n">privparams</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">()).</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">priv_d</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'d = ([0-9]*)'</span><span class="p">).</span><span class="n">search</span><span class="p">(</span><span class="n">privparams</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">()).</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">priv_p</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'p = ([0-9]*)'</span><span class="p">).</span><span class="n">search</span><span class="p">(</span><span class="n">privparams</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">()).</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">priv_q</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'q = ([0-9]*)'</span><span class="p">).</span><span class="n">search</span><span class="p">(</span><span class="n">privparams</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">()).</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">priv_e</span> <span class="o">=</span> <span class="n">mpz</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'e = ([0-9]*)'</span><span class="p">).</span><span class="n">search</span><span class="p">(</span><span class="n">privparams</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">()).</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Check if maths are ok
</span><span class="k">assert</span> <span class="n">priv_n</span> <span class="o">==</span> <span class="n">n</span>
<span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="n">priv_p</span> <span class="o">*</span> <span class="n">priv_q</span>

<span class="c1"># Decrypt c to get the flag
</span><span class="n">pt</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">priv_d</span><span class="p">,</span> <span class="n">priv_n</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Flag: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">pt</span><span class="p">)))</span>
</pre></table></code></div></div><p>Thanks for reading &lt;3</p><p>h3x</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/picoctf/'>picoctf</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/diffie-hellman/" class="post-tag no-text-decoration" >diffie-hellman</a> <a href="/tags/rsa/" class="post-tag no-text-decoration" >rsa</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PicoCTF 2022 - Crypto Challenges - h3xit's ~&url=https://h3xitsec.github.io/posts/picoctf-crypto/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=PicoCTF 2022 - Crypto Challenges - h3xit's ~&u=https://h3xitsec.github.io/posts/picoctf-crypto/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=PicoCTF 2022 - Crypto Challenges - h3xit's ~&url=https://h3xitsec.github.io/posts/picoctf-crypto/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/picoctf-binary/">PicoCTF 2022 - Binary Exploitation</a><li><a href="/posts/picoctf-reverse/">PicoCTF 2022 - Reverse Engineering Challenges</a><li><a href="/posts/picoctf-crypto/">PicoCTF 2022 - Crypto Challenges</a><li><a href="/posts/htb-routerspace/">Hack The Box - RouterSpace</a><li><a href="/posts/polyctf-crypto/">24H@CTF - Crypto</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege escalation</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/eternalblue/">eternalblue</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/radare2/">radare2</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/picoctf-reverse/"><div class="card-body"> <em class="timeago small" date="2022-03-29 00:00:00 -0400" >Mar 29</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PicoCTF 2022 - Reverse Engineering Challenges</h3><div class="text-muted small"><p> Bloat.py Challenge 1 2 Can you get the flag? Run this Python program in the same directory as this encrypted flag. We are given 2 files: bloat.flag.py : a script that asks for a password and gi...</p></div></div></a></div><div class="card"> <a href="/posts/picoctf-binary/"><div class="card-body"> <em class="timeago small" date="2022-03-30 00:00:00 -0400" >Mar 30</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PicoCTF 2022 - Binary Exploitation</h3><div class="text-muted small"><p> Binary Overflow 0 Challenge 1 2 3 4 5 Smash the stack Let&#39;s start off simple, can you overflow the correct buffer? The program is available here. You can view source here. And connect with it usin...</p></div></div></a></div><div class="card"> <a href="/posts/htb-routerspace/"><div class="card-body"> <em class="timeago small" date="2022-03-08 00:00:00 -0500" >Mar 8</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - RouterSpace</h3><div class="text-muted small"><p> Challenge description https://app.hackthebox.com/machines/RouterSpace This VM is a medium Linux machine Reconnaissance / Enumeration Port scanning and service identification $ rustscan -a $ip ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-routerspace/" class="btn btn-outline-primary" prompt="Older"><p>Hack The Box - RouterSpace</p></a> <a href="/posts/picoctf-reverse/" class="btn btn-outline-primary" prompt="Newer"><p>PicoCTF 2022 - Reverse Engineering Challenges</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/h3xitsec">h3xit</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege escalation</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/eternalblue/">eternalblue</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/radare2/">radare2</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-79SMBN4E7F"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-79SMBN4E7F'); }); </script>
